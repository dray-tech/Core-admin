-- Core Admin Script by illremember
-- Credits to infinite yield, harkinian, dex creators
-- Version 3.1 with Multiple Prefix Support

-- Define multiple prefixes
local prefixes = {"/", ":", ";", ",", ".", "!", "?"}
local activePrefix = ";"  -- Default active prefix
local mainPrefix = ";"    -- For command bar activation

-- Function to check if a message starts with any prefix
function checkPrefix(msg)
    for _, prefix in pairs(prefixes) do
        if string.sub(msg, 1, #prefix) == prefix then
            return prefix, string.sub(msg, #prefix + 1)
        end
    end
    return nil, msg
end

-- Function to change main prefix
function changeMainPrefix(newPrefix)
    mainPrefix = newPrefix
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Prefix Changed";
        Text = "Main prefix changed to: " .. mainPrefix;
        Duration = 3;
    })
end

-- Update the GetPlayer function to work with new prefix system
function GetPlayer(String)
    local Found = {}
    local strl = String:lower()
    if strl == "all" then
        for i,v in pairs(game:GetService("Players"):GetPlayers()) do
            table.insert(Found,v)
        end
    elseif strl == "others" then
        for i,v in pairs(game:GetService("Players"):GetPlayers()) do
            if v.Name ~= lplayer.Name then
                table.insert(Found,v)
            end
        end  
    elseif strl == "me" then
        for i,v in pairs(game:GetService("Players"):GetPlayers()) do
            if v.Name == lplayer.Name then
                table.insert(Found,v)
            end
        end  
    else
        for i,v in pairs(game:GetService("Players"):GetPlayers()) do
            if v.Name:lower():sub(1, #String) == String:lower() then
                table.insert(Found,v)
            end
        end    
    end
    return Found    
end

-- Update the command handler to accept multiple prefixes
lplayer.Chatted:Connect(function(msg)
    local prefix, command = checkPrefix(msg)
    
    if prefix then
        activePrefix = prefix  -- Set active prefix for notifications
        
        -- Original commands (updated for multiple prefixes)
        if string.sub(command, 1, 5) == "kill " then
            if string.sub(command, 6) == "me" then
                lplayer.Character.HumanoidRootPart.CFrame = CFrame.new(100000,0,100000)
            else
                for i,v in pairs(GetPlayer(string.sub(command, 6)))do
                    local NOW = lplayer.Character.HumanoidRootPart.CFrame
                    lplayer.Character.Humanoid.Name = 1
                    local l = lplayer.Character["1"]:Clone()
                    l.Parent = lplayer.Character
                    l.Name = "Humanoid"
                    wait(0.1)
                    lplayer.Character["1"]:Destroy()
                    game:GetService("Workspace").CurrentCamera.CameraSubject = lplayer.Character
                    lplayer.Character.Animate.Disabled = true
                    wait(0.1)
                    lplayer.Character.Animate.Disabled = false
                    lplayer.Character.Humanoid.DisplayDistanceType = "None"
                    for i,v in pairs(game:GetService'Players'.LocalPlayer.Backpack:GetChildren())do
                    lplayer.Character.Humanoid:EquipTool(v)
                    end
                    local function tp(player,player2)
                    local char1,char2=player.Character,player2.Character
                    if char1 and char2 then
                    char1:MoveTo(char2.Head.Position)
                    end
                    end
                    wait(0.1)
                    lplayer.Character.HumanoidRootPart.CFrame = game:GetService("Players")[v.Name].Character.HumanoidRootPart.CFrame
                    wait(0.2)
                    lplayer.Character.HumanoidRootPart.CFrame = game:GetService("Players")[v.Name].Character.HumanoidRootPart.CFrame
                    wait(0.5)
                    lplayer.Character.HumanoidRootPart.CFrame = CFrame.new(Vector3.new(-100000,10,-100000))
                    wait(0.7)
                    tp(lplayer,game:GetService("Players")[v.Name])
                    wait(0.7)
                    lplayer.Character.HumanoidRootPart.CFrame = NOW
                    game:GetService("StarterGui"):SetCore("SendNotification", {
                    Title = "Tools needed!";
                    Text = "You need a tool in your backpack for this command!";
                    })
                end
            end
        end
        
        -- Bring command
        if string.sub(command, 1, 6) == "bring " then
            for i,v in pairs(GetPlayer(string.sub(command, 7)))do
                local NOW = lplayer.Character.HumanoidRootPart.CFrame
                lplayer.Character.Humanoid.Name = 1
                local l = lplayer.Character["1"]:Clone()
                l.Parent = lplayer.Character
                l.Name = "Humanoid"
                wait(0.1)
                lplayer.Character["1"]:Destroy()
                game:GetService("Workspace").CurrentCamera.CameraSubject = lplayer.Character
                lplayer.Character.Animate.Disabled = true
                wait(0.1)
                lplayer.Character.Animate.Disabled = false
                lplayer.Character.Humanoid.DisplayDistanceType = "None"
                for i,v in pairs(game:GetService'Players'.LocalPlayer.Backpack:GetChildren())do
                lplayer.Character.Humanoid:EquipTool(v)
                end
                local function tp(player,player2)
                local char1,char2=player.Character,player2.Character
                if char1 and char2 then
                char1.HumanoidRootPart.CFrame = char2.HumanoidRootPart.CFrame
                end
                end
                local function getout(player,player2)
                local char1,char2=player.Character,player2.Character
                if char1 and char2 then
                char1:MoveTo(char2.Head.Position)
                end
                end
                tp(game:GetService("Players")[v.Name], lplayer)
                wait(0.2)
                tp(game:GetService("Players")[v.Name], lplayer)
                wait(0.5)
                lplayer.Character.HumanoidRootPart.CFrame = NOW
                wait(0.5)
                getout(lplayer, game:GetService("Players")[v.Name])
                wait(0.3)
                lplayer.Character.HumanoidRootPart.CFrame = NOW
                game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Tools needed!";
                Text = "You need a tool in your backpack for this command!";
                })
            end
        end
        
        -- Fly command
        if string.sub(command, 1, 4) == "fly" then
        repeat wait() until lplayer and lplayer.Character and lplayer.Character:FindFirstChild('HumanoidRootPart') and lplayer.Character:FindFirstChild('Humanoid')
        repeat wait() until Mouse
       
        local T = lplayer.Character.HumanoidRootPart
        local CONTROL = {F = 0, B = 0, L = 0, R = 0}
        local lCONTROL = {F = 0, B = 0, L = 0, R = 0}
        local SPEED = speedget
       
        local function fly()
            flying = true
            local BG = Instance.new('BodyGyro', T)
            local BV = Instance.new('BodyVelocity', T)
            BG.P = 9e4
            BG.maxTorque = Vector3.new(9e9, 9e9, 9e9)
            BG.cframe = T.CFrame
            BV.velocity = Vector3.new(0, 0.1, 0)
            BV.maxForce = Vector3.new(9e9, 9e9, 9e9)
            spawn(function()
            repeat wait()
            lplayer.Character.Humanoid.PlatformStand = true
            if CONTROL.L + CONTROL.R ~= 0 or CONTROL.F + CONTROL.B ~= 0 then
            SPEED = 50
            elseif not (CONTROL.L + CONTROL.R ~= 0 or CONTROL.F + CONTROL.B ~= 0) and SPEED ~= 0 then
            SPEED = 0
            end
            if (CONTROL.L + CONTROL.R) ~= 0 or (CONTROL.F + CONTROL.B) ~= 0 then
            BV.velocity = ((workspace.CurrentCamera.CoordinateFrame.lookVector * (CONTROL.F + CONTROL.B)) + ((workspace.CurrentCamera.CoordinateFrame * CFrame.new(CONTROL.L + CONTROL.R, (CONTROL.F + CONTROL.B) * 0.2, 0).p) - workspace.CurrentCamera.CoordinateFrame.p)) * SPEED
            lCONTROL = {F = CONTROL.F, B = CONTROL.B, L = CONTROL.L, R = CONTROL.R}
            elseif (CONTROL.L + CONTROL.R) == 0 and (CONTROL.F + CONTROL.B) == 0 and SPEED ~= 0 then
            BV.velocity = ((workspace.CurrentCamera.CoordinateFrame.lookVector * (lCONTROL.F + lCONTROL.B)) + ((workspace.CurrentCamera.CoordinateFrame * CFrame.new(lCONTROL.L + lCONTROL.R, (lCONTROL.F + lCONTROL.B) * 0.2, 0).p) - workspace.CurrentCamera.CoordinateFrame.p)) * SPEED
            else
            BV.velocity = Vector3.new(0, 0.1, 0)
            end
            BG.cframe = workspace.CurrentCamera.CoordinateFrame
                    until not flying
                    CONTROL = {F = 0, B = 0, L = 0, R = 0}
                    lCONTROL = {F = 0, B = 0, L = 0, R = 0}
                    SPEED = 0
                    BG:destroy()
                    BV:destroy()
                    lplayer.Character.Humanoid.PlatformStand = false
                end)
            end
        Mouse.KeyDown:connect(function(KEY)
            if KEY:lower() == 'w' then
                CONTROL.F = speedfly
            elseif KEY:lower() == 's' then
                CONTROL.B = -speedfly
            elseif KEY:lower() == 'a' then
                CONTROL.L = -speedfly
            elseif KEY:lower() == 'd' then
                CONTROL.R = speedfly
            end
        end)
        Mouse.KeyUp:connect(function(KEY)
            if KEY:lower() == 'w' then
                CONTROL.F = 0
            elseif KEY:lower() == 's' then
                CONTROL.B = 0
            elseif KEY:lower() == 'a' then
                CONTROL.L = 0
            elseif KEY:lower() == 'd' then
                CONTROL.R = 0
            end
        end)
        fly()
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Fly Enabled";
            Text = "Use WASD to fly. Use " .. activePrefix .. "unfly to disable.";
        })
        end
        
        -- Unfly command
        if string.sub(command, 1, 5) == "unfly" then
            flying = false
            lplayer.Character.Humanoid.PlatformStand = false
        end
        
        -- Speed command
        if string.sub(command, 1, 6) == "speed " then
            lplayer.Character.Humanoid.WalkSpeed = tonumber(string.sub(command, 7)) or 16
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Speed Changed";
                Text = "Walk speed set to: " .. lplayer.Character.Humanoid.WalkSpeed;
            })
        end
        
        -- Goto command
        if string.sub(command, 1, 5) == "goto " then
            for i,v in pairs(GetPlayer(string.sub(command, 6))) do
                lplayer.Character.HumanoidRootPart.CFrame = game:GetService("Players")[v.Name].Character.HumanoidRootPart.CFrame
            end
        end
        
        -- Noclip command
        if string.sub(command, 1, 6) == "noclip" then
            noclip = true
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Noclip Enabled";
                Text = "Use " .. activePrefix .. "clip to disable";
            })
        end
        
        -- Clip command
        if string.sub(command, 1, 4) == "clip" then
            noclip = false
        end
        
        -- God command
        if string.sub(command, 1, 3) == "god" then
            lplayer.Character.Humanoid.Name = 1
            local l = lplayer.Character["1"]:Clone()
            l.Parent = lplayer.Character
            l.Name = "Humanoid"
            wait(0.1)
            lplayer.Character["1"]:Destroy()
            game:GetService("Workspace").CurrentCamera.CameraSubject = lplayer.Character
            lplayer.Character.Animate.Disabled = true
            wait(0.1)
            lplayer.Character.Animate.Disabled = false
            lplayer.Character.Humanoid.DisplayDistanceType = "None"
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "FE Godmode Enabled";
                Text = "Use " .. activePrefix .. "grespawn to remove";
            })
        end
        
        -- View command
        if string.sub(command, 1, 5) == "view " then
            for i,v in pairs(GetPlayer(string.sub(command, 6))) do
                if game:GetService("Players")[v.Name].Character.Humanoid then
                    game:GetService("Workspace").CurrentCamera.CameraSubject = game:GetService("Players")[v.Name].Character.Humanoid
                else
                    game:GetService("Workspace").CurrentCamera.CameraSubject = game:GetService("Players")[v.Name].Character.Head
                end
            end
        end
        
        -- Unview command
        if string.sub(command, 1, 6) == "unview" then
            if lplayer.Character.Humanoid then
                game:GetService("Workspace").CurrentCamera.CameraSubject = lplayer.Character.Humanoid
            else
                game:GetService("Workspace").CurrentCamera.CameraSubject = lplayer.Character.Head
            end
        end
        
        -- Chat command
        if string.sub(command, 1, 5) == "chat " then
            game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer((string.sub(command, 6)), "All")
        end
        
        -- Reset command
        if string.sub(command, 1, 5) == "reset" then
            lplayer.Character.Head:Destroy()
        end
        
        -- Sit command
        if string.sub(command, 1, 3) == "sit" then
            lplayer.Character.Humanoid.Sit = true
        end
        
        -- Invisible command
        if string.sub(command, 1, 10) == "invisible" then
            Local = game:GetService('Players').LocalPlayer
            Char  = Local.Character
            touched,tpdback = false, false
            box = Instance.new('Part',workspace)
            box.Anchored = true
            box.CanCollide = true
            box.Size = Vector3.new(10,1,10)
            box.Position = Vector3.new(0,10000,0)
            box.Touched:connect(function(part)
                if (part.Parent.Name == Local.Name) then
                    if touched == false then
                        touched = true
                        function apply()
                            if script.Disabled ~= true then
                                no = Char.HumanoidRootPart:Clone()
                                wait(.25)
                                Char.HumanoidRootPart:Destroy()
                                no.Parent = Char
                                Char:MoveTo(loc)
                                touched = false
                            end end
                        if Char then
                            apply()
                        end
                    end
                end
            end)
            repeat wait() until Char
            loc = Char.HumanoidRootPart.Position
            Char:MoveTo(box.Position + Vector3.new(0,.5,0))
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Invisibility Enabled!";
                Text = "Reset or use " .. activePrefix .. "respawn to remove.";
            })
        end
        
        -- Version command
        if string.sub(command, 1, 7) == "version" then
            print("Core Admin by illremember, Version 3.1")
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Core Admin Version";
                Text = "Core Admin by illremember, Version 3.1";
            })
        end
        
        -- Commands list
        if string.sub(command, 1, 4) == "cmds" then
            CMDSFRAME.Visible = true
        end
        
        -- FE Check
        if string.sub(command, 1, 7) == "fecheck" then
            if game:GetService("Workspace").FilteringEnabled == true then
                warn("FE is Enabled (Filtering Enabled)")
                game:GetService("StarterGui"):SetCore("SendNotification", {
                    Title = "FE is Enabled";
                    Text = "Filtering Enabled. Enjoy using Core Admin!";
                })
            else
                warn("FE is Disabled (Filtering Disabled) Consider using a different admin script.")
                game:GetService("StarterGui"):SetCore("SendNotification", {
                    Title = "FE is Disabled";
                    Text = "Filtering Disabled. Consider using a different admin script.";
                })
            end
        end
        
        -- Prefix change command
        if string.sub(command, 1, 7) == "prefix " then
            local newPrefix = string.sub(command, 8, 8)
            changeMainPrefix(newPrefix)
        end
        
        -- Reset prefix command
        if string.sub(command, 1, 11) == "resetprefix" then
            changeMainPrefix(";")
        end
        
        -- Default command
        if string.sub(command, 1, 7) == "default" then
            lplayer.Character.Humanoid.JumpPower = 50
            lplayer.Character.Humanoid.WalkSpeed = 16
            lplayer.Character.Humanoid.HipHeight = 0
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Default Settings";
                Text = "Speed, jump power, and hip height reset to default";
            })
        end
        
        -- Teleport me command (alternative to goto)
        if string.sub(command, 1, 7) == "tp me " then
            for i,v in pairs(GetPlayer(string.sub(command, 8))) do
                lplayer.Character.HumanoidRootPart.CFrame = game:GetService("Players")[v.Name].Character.HumanoidRootPart.CFrame
            end
        end
        
        -- [ADD ALL OTHER COMMANDS HERE WITH SAME PATTERN...]
        -- For each command, remove the old prefix check and use the new system
        
        -- NEW SPIN OBJECT COMMAND
        if string.sub(command, 1, 9) == "spinobj " then
            local args = string.split(string.sub(command, 10), " ")
            local objectName = args[1]
            local speed = args[2] or 50
            spinObject(objectName, tonumber(speed))
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Spinning Object";
                Text = "Spinning " .. objectName .. " at speed " .. speed;
            })
        end
        
        -- AIMBOT COMMAND
        if string.sub(command, 1, 6) == "aimbot" then
            enableAimbot()
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Aimbot Enabled";
                Text = "Aimbot is now active";
            })
        end
        
        -- EXPLODE ME COMMAND
        if string.sub(command, 1, 9) == "explodeme" then
            explodeSelf()
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Boom!";
                Text = "You exploded yourself";
            })
        end
        
        -- FLINGALL COMMAND
        if string.sub(command, 1, 8) == "flingall" then
            flingAllPlayers()
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Flinging All";
                Text = "Flinging all players";
            })
        end
        
        -- FLINGOTHERS COMMAND
        if string.sub(command, 1, 10) == "flingothers" then
            flingOthers()
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Flinging Others";
                Text = "Flinging other players";
            })
        end
        
        -- FLINGME COMMAND
        if string.sub(command, 1, 7) == "flingme" then
            flingSelf()
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Flinging Self";
                Text = "Flinging yourself";
            })
        end
        
        -- STOPFLING COMMAND
        if string.sub(command, 1, 9) == "stopfling" then
            stopAllFling()
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Fling Stopped";
                Text = "Stopped all flinging";
            })
        end
        
        -- [CONTINUE WITH ALL OTHER NEW COMMANDS...]
        
    end
end)

-- Update the command bar to show all prefixes
CMDBAR.Text = "Press " .. mainPrefix .. " to type commands. Prefixes: / : ; , . ! ?"

-- Update the keyboard activation to use main prefix
Mouse.KeyDown:connect(function(Key)
    if Key == mainPrefix then
        CMDBAR:CaptureFocus()
    end
end)

-- Update the command bar execution
CMDBAR.FocusLost:connect(function(enterPressed)
    if enterPressed then
        local cmd = CMDBAR.Text
        -- Try each prefix
        for _, prefix in pairs(prefixes) do
            if string.sub(cmd, 1, #prefix) == prefix then
                lplayer.Chatted:FireServer(cmd)
                break
            end
        end
        CMDBAR.Text = ""
    end
end)

-- Update the intro message to show all prefixes
wait(0.3)
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "Core Admin Loaded!";
    Text = "Multiple Prefixes: / : ; , . ! ?";
    Icon = "rbxassetid://4457851885";
    Duration = 5;
})

-- Update the command list UI to show prefix info
local commandsText = table.concat(Commands, "\n")
TextLabel.Text = "Available Prefixes: / : ; , . ! ?\n\n" .. commandsText

-- Add prefix info to mobile button tooltip
MobileButton.MouseButton1Click:Connect(function()
    CMDSFRAME.Visible = not CMDSFRAME.Visible
    if CMDSFRAME.Visible then
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Commands List";
            Text = "Use any prefix: / : ; , . ! ?";
            Duration = 2;
        })
    end
end)

-- Update the title to show version
Title.Text = "Core Admin V3.1 - Prefix: " .. mainPrefix
